---
title:  "ASP.NET MVC를 사용해야 하는 다섯가지 이유"
date:   2014-09-26
categories: mvc
---

ASP부터 시작해서 ASP.NET 웹폼을 오랜동안 실무에서 사용했던 경험자로서 ASP.NET MVC이 어떤 이유로 좋은지 이야기해 보고자 한다. 웹폼과 MVC를 비교하는 많은 아티클에서 공통적으로 맺는 말은 두 기술은 어느 한 기술이 다른 것을 대치하는 것이 아니라는 것이다. MVC가 좋다는 뉘앙스를 풍기면서도 웹폼을 버리라고 과감하게 말하는 사람은 없다. 웹폼이 제공하는 다양한 서버 컨트롤과 뷰 스테이트는 생산성 향상에 큰 도움이 되고 있는걸 알기 때문이다. 그럼에도 불구하고 MVC를 선택해야 하는 이유는 무엇일까?

# 웹폼은 이래서 힘들다

- 웹폼이 유지보수하기 어려운 이유는 프로젝트를 구성하는 아키텍쳐가 약하기 때문이다. 관심사 분리(Separation of concerns: SoC) 는 웹폼의 패러다임이 아니다. 웹폼 프로젝트가 개발자에게 강요하는 멋진 구조 같은 것이 없으므로 결과물의 수준은 개발자의 설계능력에 비례한다.

- 이벤트 드리븐 방식의 코딩 패턴은 전체 흐름을 파악하기에 불편하다.

- 특정 목적으로 이벤트를 세심하게 선택해야 할 때, 페이지의 라이프 사이클과 더불어 컨트롤의 라이프 사이클까지 고려하는 것은 필요 이상으로 복잡하다.

- 웹폼에서도 테스트를 자동화 하는 것이 가능하다. 아주 어려울 뿐이다. 웹폼은 단단하게 꽉 묶여진 하나의 런타임 환경에서 돌아가는데 이 환경이 테스트 모듈과 얘기하면서 돌아갈만큼 유연하지 않다.

- 상태를 유지하기 위해 웹폼에 도입한 뷰스테이트는 ASP 개발자에게 너무나도 반가운 소식이었다. 그러나, 뷰스테이트는 페이지의 크기에 한몫하여 반응 속도를 떨어뜨릴 뿐만 아니라 가끔 꼬여서 런타임 에러를 뱉어낸다. ASP.NET 4.0 부터 뷰스테이트를 비활성화할 수 있게 되었다.

- HTML에 대한 주도권을 빼앗아 간다. input 요소들의 id를 폼의 이름과 혼합하여 지어내므로 개발자들을 즐겁게 해주는 자바스크립트 라이브러리를 같이 사용하기가 힘들다. ASP.NET 4.0부터 나아지기는 했다.

- 웹폼은 SEO(Search Engine Optimization) 친화적이지 않다. 검색엔진은 사용자가 웹 사이트를 사용하는 것과 비슷한 패턴으로 웹 페이지의 중요도를 판단한다. 페이지의 타이틀과 URL은 이런면에서 아주 중요하다 (3.5 SP1 부터 웹폼에서도 routing이 지원되어 aspx로 끝나는 URL을 피할 수 있다). 또한, 링크와 파라미터도 검색엔진에 의해 참조되는데 뷰스테이트를 통해 폐쇄적으로 파라미터를 포스트백하는 방식은 검색엔진에게 노출될 수 있는 기회를 더욱 줄인다.

<br />

# 웹폼과 MVC 프레임워크가 구별되는 구조적인 차이점

웹폼과 MVC를 구별하는 핵심적인 차이는 관련된 패턴이다. 웹폼은 Page Controller 패턴에 기반한 모델이다. 페이지라는 개념을 중심에 두고 사용자 인터페이스를 다루는데 초점이 있다. 따라서, 페이지가 입력을 받고 또, 제출(포스트백해서 저장)하고 브라우저에게 보내는 응답까지 결정한다. 어떻게 보면 대단한 능력같기도 하다. 상황이 이렇다 보니 관심사 분리(SoC)를 딱히 막는 구조는 아니지만, 컨트롤을 드래그앤드랍(데이터 소스도 드래드앤드랍)하여 코드비하인드에서 몇 줄 코딩으로 완벽한 기능을 구현할 수 있는 유혹을 떨치기 어렵다.

MVC 프레임워크는 Model-View-Controller 에 기반하여 관심사의 분리가 자연스럽게 되는 구조를 갖고 있다. 그 덕에 코드의 재활용도가 높고 깔끔한 프로젝트 구조는 유지보수와 확장을 쉽게 해준다. 웹폼이 생산성이라면 MVC는 확장성이라고 할 수 있다.

![The Sequence Diagram of an ASP.NET MVC Request](/assets/mvc/aspnet-mvc-request.gif)

[그림-1] The Sequence Diagram of an ASP.NET MVC Request

(그림 출처 - [Comparing Web Forms And ASP.NET MVC])

<br />

# MVC는 이래서 힘들다

러닝커브가 심하다. 공부할 것이 너무 많고 다소 어렵기도 하다.

- Model-View-Controller 라는 패턴 자체가 첫번째 공부의 대상이다. 로직을 모델에 넣어야 한다고 했는데, 어느새 나도 모르게 컨트롤러에 넣고 있다. 관심사 분리(SoC)의 원칙을 지켜야지!

- MVC는 테스트가 쉽다고 알고 있다. 컨트롤러를 테스트하는게 그야말로 쉬운게 컨트롤러 클래스를 생성해서 사용하면 그만이다. 문제는 데이터를 컨트롤러에 전달해서 조회 또는 저장되는 결과를 봐야하는데, 테스트 내용이 데이터베이스에 직접 반영되길 원하지는 않을 것이다. 리포지토리 패턴에 대해 알아볼 기회가 온것이다. 더불어, mocking하는 좋은 툴도 살펴봐야 할 것이다.

- 제어 반전(Inversion of Control) 패턴이 많이 쓰인다. 의존성 주입(Dependency Injection: DI)을 심각하게 고민해야 한다. 이를 위해서 interface를 사용하여 프로그래밍에 익숙해져야 한다.

- HTML을 통치할 완벽한 자유를 얻는다는 건, 그걸 또 원하는대로 잘 사용해야 한다는 것이다. 그러나, 직접 HTML DOM를 다루고 싶어 하는 사람이 많지는 않을 것이다. jQuery는 필수이고 이 자바스크립트 라이브러리 덕에 클라이언트 스크립팅은 비약의 발전을 거듭해 이제는 너무도 많은 라이브러리를 두고 무엇을 선택해야 하는지가 고민이다. 선택의 기로에서 제일 좋은 방법은 써보는 수밖에. 하지만 서버 페이지만 코딩하다 자바스크립트의 너무나도 유연한 자태를 보면 짜증도 벌컥난다.

- 이제는 CSS에도 변수를 쓰는 시대, 잘 알아두면 스타일 관리를 깔끔하게 할 수 있다. 자바스크립트보다 더 어려워 보인다.

<br />

# 진실과 선택

- 웹폼은 테스트하기가 어렵다.
- ASP.NET MVC는 개발자가 HTML을 잘 다룰거라고 생각한다.
- ASP.NET MVC는 ASP.NET에서 관심사 분리 원칙을 구현하는 유일한 방법은 아니다.
- 웹폼은 개발자가 처음부터 다 알고 시작하는 것이 아니다. 공부하면서 해도 충분하다.
- 뷰스테이트도 이제 관리가 가능하고 심지어 기능을 꺼둘 수도 있다.
- 웹폼은 웹의 작동방식을 추상화하기 위해 디자인되었다.
- ASP.NET MVC는 웹 아키텍쳐를 노출한다.
- ASP.NET MVC는 테스트와 의존성 주입을 염두에 두고 설계되었다.
- ASP.NET MVC는 개발자가 좀더 나은 디자인의 코딩을 하도록 돕는다.
- ASP.NET MVC는 아직 역사가 짧고 컴포넌트 모델이 부족하다.
- ASP.NET MVC는 웹폼의 안티가 아니다

애초 글 작성의 의도가 MVC의 장점을 조명해 보고자 하는 것이었으나, 이 것은 단지 개인의 선호일 수도 있겠다는 생각에 도달했다. 당연히 MVC로 가야지 하는 것은 단지 내 입장에서만 생각할 수 있었던 하나의 의견일 뿐이다.

한가지 예로, 누구는 클라이언트 브라우저에서 자바스크립트와 CSS로 HTML 요소들을 만지작 거리는 것을 재미있어 한다. 그래서 HTML에 대한 전권을 획득할 수 있는 MVC를 선호하는 반면, Raw HTML이 어색한 누군가에게는 MVC가 필요없는 직접적인 이유가 될 것이다.

선택의 기로에 있는 개발자를 위해, 내가 MVC를 사용하는 다섯가지 이유를 뽑자는 다음과 같다.

<br />

# ASP.NET MVC를 사용해야 하는 다섯가지 이유

1. 단연코 테스트의 용이함을 들 수 있겠다. QA(Quality Assurance) 차원에서 애플리케이션의 완성도를 높이는 것이 직접적인 혜택이겠으나 테스트 위주로 사고하면 애플리케이션의 구조가 좋아진다.

2. HTML을 직접 다룰수 있어 반응형 웹과 모바일 디바이스 지원측면에서 좋은 전략을 세울 수 있다.

3. 사용자 인터페이스(View)와 컨트롤러간 정보 전달이 쉽다. 모델 바인딩은 폼의 요소가 POST 될때, 액션에 정의한 매개변수와 같은 이름의 요소를 찾아 액션에 정의된 데이터 타입으로 컨버팅해주는 기술이다. 클래스 멤버의 이름과 폼 요소의 이름을 비교하여 클래스 개체도 문제없이 생성해 준다. 반대로 View로 데이터를 보낼 때는, 뷰 모델을 정의하여 클래스 단위로 깔금하게 데이터를 전달할 수 있다.

4. URL 라우팅이 유용하다. URL을 어떻게 구성하고 해석할 것인지 쉽게 정할 수 있다.

5. ASP.NET 파이프라인이 간결하다. 페이지 라이프 사이클이 복잡한 웹폼과 비교하여 훨씬 단순하고 Http 모듈과 비슷한 기능을 하는 사용자 정의 Http 핸들러를 작성하는 것도 쉽다. 아래 그림에서 웹폼의 파이프라인은 가독성을 위해 페이지의 라이프 사이클이 생략되어 있다는 것에 유의하자.

<br />

![ASP.NET 런타임 스택] (/assets/mvc/mvc-runtime-stack.gif)

[그림-2] ASP.NET 런타임 스택

(그림 출처 - [Comparing Web Forms And ASP.NET MVC])

<br />

### 참조 글
* [Comparing Web Forms And ASP.NET MVC]
* [WebForms vs. MVC](http://www.codeproject.com/Articles/528117/WebForms-vs-MVC)

[Comparing Web Forms And ASP.NET MVC]: https://msdn.microsoft.com/en-us/magazine/dd942833.aspx
